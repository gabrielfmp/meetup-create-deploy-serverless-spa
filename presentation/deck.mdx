## Create and Deploy Serverless SPAs

import { swiss } from 'mdx-deck/themes'
import SetTopicAndQuestion from './components/SetTopicAndQuestion';
import Question from './components/Question';
import { Image, Appear, Notes } from 'mdx-deck';
import {
  Invert,
  Split,
  SplitRight,
  Horizontal,
  FullScreenCode,
} from 'mdx-deck'

export const theme = swiss;

<img src="https://img.stackshare.io/service/6590/hasura_logo_vertical_black.png" alt="drawing" style="width:200px;"/>
<img src="https://res.cloudinary.com/practicaldev/image/fetch/s--K2q0A5SX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/2elgd5zp07wkeilkna63.png" alt="drawing" style="width:260px;height:180px;"/>
<img src="https://miro.medium.com/max/418/1*vMEcwH5CYFXdaX-TTkfgKw.png" alt="drawing" style="width:200px;"/>
<img src="https://miro.medium.com/max/7126/1*MLkTe5tPVv5BhXERsOO-MQ.png" alt="drawing" style="width:340px;height:180px;"/>


<SetTopicAndQuestion />

---

<Split>

  # Demo

  [https://topics-voting-gpb7nqwtva-uc.a.run.app/](https://topics-voting-gpb7nqwtva-uc.a.run.app/)

  ![](https://static-bzaem6kli.now.sh/qrcode.png)

</Split>

<SetTopicAndQuestion topic={'9a1eb860-227a-4f1f-b1fb-880419bbe33a'} />

---
### About Me

- Software Engineer at Farfetch
- Enjoy experimenting and mixing different technologies

<SetTopicAndQuestion topic={'9a1eb860-227a-4f1f-b1fb-880419bbe33a'} />

---

### Main topics

* Serverless
* SPAs
* GraphQL
* Deployment

<SetTopicAndQuestion topic={'9a1eb860-227a-4f1f-b1fb-880419bbe33a'} />

---

### Some Context

- Constantly evolving technology
- Overwhelming
- Hard time to quickly develop ideas

<SetTopicAndQuestion topic={'f05f513a-19b6-46ac-b259-2ea4df0df2df'} />

---

### Quiz Time

<Question question={'303a9643-3d69-4382-a7d5-7ae94e2df5b6'} />

<SetTopicAndQuestion topic={'f05f513a-19b6-46ac-b259-2ea4df0df2df'} question={'303a9643-3d69-4382-a7d5-7ae94e2df5b6'} />

---

### Connect the Dots

- Recent technologies
- Simpler architectures
- Powerful applications

<SetTopicAndQuestion topic={'f05f513a-19b6-46ac-b259-2ea4df0df2df'} />

---

### What this talk is about

- Focus on connecting some different technologies
- Define powerful architectures in simple ways
- Share your ideas with the world

<SetTopicAndQuestion topic={'f05f513a-19b6-46ac-b259-2ea4df0df2df'} />

---

### What this talk is not about

- In depth explanation of each technology

- Reach out if you are need help with a starting point

<SetTopicAndQuestion topic={'f05f513a-19b6-46ac-b259-2ea4df0df2df'} />

---

### Serverless

- Abstract complexity from managing Infrastructure
- Scale from 0 to n
  - Scale up when receive requests
  - Scale down when idle

<Notes>
  Notes about serverless
</Notes>

<SetTopicAndQuestion topic={'2136d37c-d1d4-4dd5-a9eb-70155576cbbe'} />

---

### Project template

<img src="https://seeklogo.com/images/N/next-js-logo-7929BCD36F-seeklogo.com.png" alt="drawing" style="width:200px;height:60px;"/>

- React Framework with SSR capabilities
- Concept of pages
- Serverless mode - since version 8
  - Page as an independently deployable unit (lambda).
  - After SSR of the pages they act as a SPA

<SetTopicAndQuestion topic={'8ca7c369-2f5d-4d5b-9335-8486a7ec5328'} />

---

### Project template

![](https://miro.medium.com/max/1454/1*3e9V8u5vK1E_KHB0dk_8Nw.png)

- Opensource Serverless platform
- Containers as unit of deployment
- Function templates


<SetTopicAndQuestion topic={'8ca7c369-2f5d-4d5b-9335-8486a7ec5328'} />

---

### Project template

- OpenFaaS template for Next.js on Serverless mode
  - Base setup for functions served with Next.js on Serverless mode
    - Easy and quick deployment of React Components
  
<SetTopicAndQuestion topic={'8ca7c369-2f5d-4d5b-9335-8486a7ec5328'} />

---

### Project template

[Create and Deploy Serverless SPAs with Next.js on OpenFaaS or Knative (Google Cloud Run)](https://medium.com/@johnnyeric/create-and-deploy-serverless-spas-with-next-js-on-openfaas-or-knative-google-cloud-run-4b32a073292b)

<SetTopicAndQuestion topic={'8ca7c369-2f5d-4d5b-9335-8486a7ec5328'} />

---

### Hasura

- OpenSource
- Automatic GraphQL API based on PostgreSQL tables
- Triggers
- Authorization

<SetTopicAndQuestion topic={'c4a16982-e739-4a8c-b218-576d4ff51245'} />

---

### 3 Factor App

- Architecture pattern
- Factors:
  1. Realtime GraphQL
  2. Reliable Eventing
  3. Async Serverless

<SetTopicAndQuestion topic={'c4a16982-e739-4a8c-b218-576d4ff51245'} />

---
### 3 Factor App

![3 factor app](https://3factor.app/3factor-migration.png)

<SetTopicAndQuestion topic={'c4a16982-e739-4a8c-b218-576d4ff51245'} />

---

<SplitRight>

  ## Application Architecture

  <img src="https://static-bzaem6kli.now.sh/architecture.png" alt="drawing" style="width:560px;height:610px;"/>

</SplitRight>

<SetTopicAndQuestion topic={'8646ba53-d05d-4b88-9030-b1c88aaf47a0'} />

---

### Main Components

- Hasura instance
  - Hosted on Heroku
- Serverless function to set the current topic and question
  - Hosted on Google Cloud Run
- SPA
  - Hosted on Google Cloud Run

<SetTopicAndQuestion topic={'ea05d876-326c-43ae-8b75-e76ccd0e71f2'} />

---

### Hands On

- Next.js Serverless Mode
- OpenFaaS template for Next.js on Serverless mode
- Build container image
- Tag image to [gcr.io](http://gcr.io) registry
- Deploy to Google Cloud Run

<SetTopicAndQuestion topic={'ea05d876-326c-43ae-8b75-e76ccd0e71f2'} />

---

### Conclusion

- Simple Serverless Architectures
- Flexibility

<SetTopicAndQuestion topic={'5f219fdb-915e-4f3f-b07c-f3dac7f58f6e'} />

---

### Reference Material

- Next.js
- Heroku
- Hasura
- OpenFaaS
- OpenFaaS Next.js Template
- Google Cloud Run
- 3 Factor App

<SetTopicAndQuestion topic={'5f219fdb-915e-4f3f-b07c-f3dac7f58f6e'} />

---

# The end

<Appear>
  <span><h2>Questions?</h2></span>
</Appear>

<SetTopicAndQuestion topic={'5f219fdb-915e-4f3f-b07c-f3dac7f58f6e'} />